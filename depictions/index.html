<!DOCTYPE html>
<html class="has-subpixel" lang="en">

<head>
	<title>Tweak Title by Author</title>

	<link rel="icon" href="http://repo.samplasion.tk/favicon.png" type="image.png" /> 

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<!--<link rel="stylesheet" href="style.css">-->
	<link rel="stylesheet" href="ios7.min.css">
	<link rel="stylesheet" href="common.css">

	<style>
		li:after {
			left: -15px;
			width: calc(100% + 15px);
		}

		.disable-selection {
			-moz-user-select: none;
			/* Firefox */
			-ms-user-select: none;
			/* Internet Explorer */
			-khtml-user-select: none;
			/* KHTML browsers (e.g. Konqueror) */
			-webkit-user-select: none;
			/* Chrome, Safari, and Opera */
			-webkit-touch-callout: none;
			/* Disable Android and iOS callouts*/
		}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery.querystring.js"></script>
	<script type="text/javascript" src="js/data-loader-engine.js"></script>
	<script type="text/javascript" src="js/ios_version_check.js"></script>
	<script type="text/javascript" src="ios7.min.js"></script>
	<link rel="shortcut icon" type="image/png" href="https://samplasion.github.io/favicon.png"/>
	<style>
		@media (max-width: 767px) {
			body {
				background: #efeff4 !important;
				margin: 0;
				padding: 0;
				border: 0;
				outline: 0;
				box-sizing: border-box
			}
		}

		.jumbotron-bg {
			background: green
		}
	</style>
	<style>
		.package-info dl {
			font-size: .85em;
			margin: 0
		}

		.package-info dl dt {
			float: left;
			clear: left;
			width: 100px;
			text-align: right;
			color: #6d6d72;
			margin-right: 8px
		}

		.package-info dl dd {
			margin-left: 108px
		}
	</style>
</head>

<body class="disable-selection">
	<main id="content" role="main">

		<div id="packageInformation">
			<article id="packageHeader" style="">
				<section>
					<ul>
						<li>
							<strong id="packageName" style="font-size:1.3em;">Tweak Name</strong>
							<br>
							<span id="packageAuthor"></span>
						</li>
					</ul>
				</section>
			</article>

			<article id="compatCheckContainer" style="display: none;">
				<header>
					<h2 id="compatibilityCheckLabel">Compatibility</h2>
				</header>
				<section class="content" id="compatibilityCheck">
					<ul>
						<li id="compatibilityCheckText"></li>
					</ul>
				</section>
			</article>

			<article>
				<!-- header><h2 id="compatibilityCheckLabel">Zebra</h2></header -->
				<section class="content" id="compatibilityCheck">
					<ul>
						<li class="arrow"><a class="link-item list-group-item" role="button"
								href="cydia://url/https://cydia.saurik.com/api/share#?source=https://xtm3x.github.io/repo/&amp;package=xyz.willy.zebra">Get
								Zebra</a></li>
					</ul>
				</section>
			</article>

			<!-- article>
				<header>
					<h2>ADVERTISEMENTS</h2>
				</header>
				<ul id="descriptionList" class="list-group">
					<li id="ad1" class="list-group-item">
						<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
						<-- Quadrato ->
						<ins class="adsbygoogle"
							style="display:block"
							data-ad-client="ca-pub-2629383633762978"
							data-ad-slot="4282165259"
							data-ad-format="auto"
							data-full-width-responsive="true"></ins>
						<script>
							(adsbygoogle = window.adsbygoogle || []).push({});
						</script>
					</li>
				</ul>
			</article -->

			<article>
				<header>
					<h2>DESCRIPTION</h2>
				</header>
				<ul id="descriptionList" class="list-group">
					<li id="desc" class="list-group-item"></li>
					<li class="arrow"><a id="screenshots" href="" role="button">Screenshots</a>
					</li>
				</ul>
			</article>

			<article>
				<label>
					<h2>IN THIS VERSION (<span id="versionBadge" class="badge"></span>)</h2>
				</label>
				<ul id="changesList" class="list-group">
					
				</ul>
			</article>

			<!-- article>
				<header>
					<h2>ADVERTISEMENTS</h2>
				</header>
				<ul id="descriptionList" class="list-group">
					<li id="ad1" class="list-group-item">
						<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
						<-- Quadrato ->
						<ins class="adsbygoogle"
							style="display:block"
							data-ad-client="ca-pub-2629383633762978"
							data-ad-slot="4282165259"
							data-ad-format="auto"
							data-full-width-responsive="true"></ins>
						<script>
							(adsbygoogle = window.adsbygoogle || []).push({});
						</script>
					</li>
				</ul>
			</article -->

			<article class="package-info" id="metadataContainer">
				<label>
					<h2>Metadata</h2>
				</label>
				<ul class="list-group">
					<li id="metadata">
						<dl>
							<dt>License</dt>
							<dd id="license">Closed Source</dd>
							<dt>Price</dt>
							<dd id="price">Free</dd>
							<dt id="sizeLabel">Size</dt>
							<dd id="size">Unknown</dd>
						</dl>
					</li>
				</ul>
			</article>

			<article id="externalLinksContainer">
				<label>
					<h2>LINKS</h2>
				</label>
				<ul id="externalLinksList" class="list-group">
					<li class="arrow"><a href="https://www.reddit.com/r/jailbreak" role="button"><span
								class="fa fa-reddit"></span>/r/jailbreak</a></li>
					<!--li class="arrow"><a href="https://github.com/Samplasion/7heaven" role="button"><span
								class="fa fa-github"></span>Source Code</a></li-->
				</ul>
			</article>

		</div>

		<div id="packageError" style="display:none">
			<article>
				<ul>
					<li>It seems like the package you are trying to view links to a broken depiction.</li>
				</ul>
			</article>
		</div>

		<!--div id="contactInfo" style="display: none;">
			<article>
				<label>
					<h2>CONTACT</h2>
				</label>
				<ul class="list-group" id="repoFooterLinks">
				</ul>
			</article>
		</div-->
	</main>

	<script>
		$(document).ready(function () {
			var dPackage = getParameterByName("p");

			if (!dPackage) {
				$("#packageError").css("display", "block");
				$("#packageInformation").css("display", "none");
				$("#packageName").text("Not found");
				return;
			}

			$.getJSON("/repo/pkgs/" + dPackage + ".json", function (data) {

				var title       = data.tabs[0].views[0].title;
				var version     = data.tabs[0].views[6].text;
				var price       = data.tabs[0].views[8].text;
				var author      = data.tabs[0].views[9].text;
				var versions    = organizeVersions(data.tabs[1].views);
				var description = data.tabs[0].views.filter(v => v.class == "DepictionMarkdownView")[0].markdown;
				var license     = data.tabs[0].views.filter(v => v.title && v.title.toLowerCase() == "license")[0].text;
				var size        = data.tabs[0].views.filter(v => v.title && v.title.toLowerCase() == "size")[0].text;

				document.title  = title + " by " + author;

				$("#packageName").text(title);
				$("#desc").html(description);
				$("#packageAuthor").text("brought to you by " + author);
				$("#license").text(license || "Closed Source");
				$("#size").text(size || "Unknown");
				$("#price").text(price || "Free");
				$("#versionBadge").text(version);
				var cList = $("#changesList");
				var change = versions[0];
				cList.append("<li class=\"list-group-item\"><p>" + change.log + "</p></li>")
				cList.append('<li class="arrow"><a id="changelog" class="link-item list-group-item" href="" role="button">Full Changelog</a></li>')

				$("#changelog").attr("href", "changelog?p=" + dPackage);
				$("#screenshots").attr("href", "screenshots?p=" + dPackage);
			})
			.fail(function (e) {
				console.log(e);
				$("#packageError").css("display", "block");
				$("#packageError article ul li").html("An error occurred while retrieving package info!<br><code>" + e.name + "</code>")
				$("#packageInformation").css("display", "none");
				$("#packageName").text("Not found");
				return;
			});

			function getParameterByName(name) {
				name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
				var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
					results = regex.exec(location.search);
				return results === null ? null : decodeURIComponent(results[1].replace(/\+/g, " "));
			}

			function organizeVersions(views) {
				var title = "",
				log = "";
				var versions = [];
				views.forEach((view, index) => {
					if (index % 2 == 0) {
						title = view.title;
					} else {
						log = view.markdown;
						versions.push({title, log});
					}
				});

				return versions;
			}
		});
	</script>

</body>

</html>